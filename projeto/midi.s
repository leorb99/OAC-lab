###############################################
#  Programa de exemplo para Syscall MIDI      #
#  ISC Abr 2018				      #
#  Marcus Vinicius Lamar		      #
###############################################

.data
# Numero de Notas a tocar
LEN_MUSIC: .word 144
# lista de nota,dura��o,nota,dura��o,nota,dura��o,...
NOTES: 76,150,76,300,76,300,72,150,76,300,79,600,55,600,72,450,67,450,64,450,69,300,71,300,70,150,69,300,67,201,76,197,79,201,81,300,77,150,79,300,76,300,72,150,74,150,71,450,72,450,67,450,64,450,69,300,71,300,70,150,69,300,67,201,76,198,79,201,81,300,77,150,79,300,76,300,72,150,74,150,71,150,79,150,78,150,77,150,75,300,76,300,68,150,69,150,72,300,69,150,72,150,74,450,79,150,78,150,77,150,75,300,76,300,84,300,84,150,84,900,79,150,78,150,77,150,75,300,76,300,68,150,69,150,72,300,69,150,72,150,74,450,75,450,74,450,72,450,43,150,43,300,36,150,72,150,72,300,72,300,72,150,74,300,76,150,72,300,69,150,67,600,72,150,72,300,72,300,72,150,74,150,76,1350,72,150,72,300,72,300,72,150,74,300,76,150,72,300,69,150,67,600,76,150,76,300,76,300,72,150,76,300,79,600,67,150,76,150,72,300,67,450,68,300,69,150,77,300,77,150,69,600,71,201,81,198,81,201,81,201,79,198,77,201,76,150,72,300,69,150,67,600,76,150,72,300,67,450,68,300,69,150,77,300,77,150,69,600,71,150,77,300,77,150,77,201,76,197,74,201,72,150,64,300,64,150,60,150

.text
MUSIC:		
		mv s11, a0 
		mv s10, a7
		mv s9, a1
		mv s8, a2
		mv s7, a3
		
		li a2,68		# define o instrumento
		li a3,127		# define o volume
	
		lw s6, LEN_MUSIC	# le o numero de notas
		la s5, NOTES		# define o endere�o das notas

TOCA:		
		beqz s6,FIM
		lw a0,0(s5)		# le o valor da nota
		lw a1,4(s5)		# le a duracao da nota
		li a7,31		# define a chamada de syscall
		ecall			# toca a nota
		mv a0, a1
		li a7,32		# define a chamada de syscal 
		ecall			# realiza uma pausa de a0 ms
		addi s5,s5,8		# incrementa para o endere�o da pr�xima nota
		addi s6,s6,-1		# incrementa o contador de notas
		j TOCA
		
SALTO:	
		li a0, 40
		li a7,31
		ecall
		li a0, 500
		li a7, 32
		ecall

FIM:		
		mv a0, s11 
		mv a7, s10
		mv a1, s9
		mv a2, s8
		mv a3, s7
		ret
